import java.io.File;
import java.io.InputStream;

import org.apache.avro.Schema;
import org.apache.avro.generic.GenericDatumReader;
import org.apache.avro.generic.GenericRecord;
import org.apache.avro.io.DatumReader;
import org.apache.avro.io.DecoderFactory;

public class SmsReceivedBolt extends EventProcessingBolt
{
	private static final long serialVersionUID = -4695049338179572315L;

	protected void processEvent(InputStream in)
	{
		Schema schema = new Schema.Parser().parse(new File("/home/user/sms_received.avsc"));
		DatumReader<GenericRecord> datumReader = new GenericDatumReader<GenericRecord>(schema);
		GenericRecord record = datumReader.read(null, DecoderFactory.get().jsonDecoder(schema, in));
		jedis.hset("sms_received", record.get("id").toString(), record.toString());
	}	
}